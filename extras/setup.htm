<!DOCTYPE html>
<html lang='ru'>
<head>
<meta name='format-detection' content='telephone=no'>
<meta charset='UTF-8'>
<meta  name='viewport' content='width=device-width,initial-scale=1,user-scalable=no'/>
<title>Настройка устройства</title>
<script>function c(l){document.getElementById('s').value=l.getAttribute('data-ssid')||l.innerText||l.textContent;p = l.nextElementSibling.classList.contains('l');document.getElementById('p').disabled = !p;if(p)document.getElementById('p').focus();};function f() {var x = document.getElementById('p');x.type==='password'?x.type='text':x.type='password';}function g(b){return document.getElementById(b);} function extraConf() {var e=g('chbox');var d='none';if(e.checked){d='block'}g('extra_conf').style.display=d;}</script>
<style>.c,body{text-align:center;font-family:verdana}div,select{padding:5px 5px 5px 0;font-size:1em;margin:5px 0;box-sizing:border-box}button,select,.msg{border-radius:.3rem;width: 100%}input[type=radio],input[type=checkbox]{width:auto}input{border:0;border-bottom:1px solid #888;padding:5px 0;font-size:1.2em;margin:5px 0;outline:0;width:100%}label{font-size:1em}.chk-box{display:block;position:relative;padding-left:35px;padding-top:25px;margin-bottom:12px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.box{position:absolute;top:25px;left:0;height:25px;width:25px;background-color:#eee;}.chk-box .box:after{left:9px;top:5px;width:5px;height:10px;border:solid #fff;border-width: 0 3px 3px 0;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);}.box:after{content:'';position:absolute;display:none;}.chk-box input:checked~.box:after{display:block;}.chk-box input:checked~.box{background-color:#C038D3;}.chk-box input{position:absolute;opacity:0;cursor:pointer;}h3{color:#C038D3;text-align:center;}.pic{animation:5s linear infinite rotate;}select{border:0;border-bottom:1px solid #888;outline:0;border-radius:0;appearance:none;-webkit-appearance:none;}button,input[type='button'],input[type='submit']{cursor:pointer;border:0;background-color:#9303A7;color:#fff;line-height:2.6rem;font-size:1.2rem;width:250px;}input[type='file']{border:1px solid #C038D3}.logo-cont{display: flex}.logo-text{display: inline;font-weight: 700;color: #9303A7;font-size: 30px;line-height: 30px;padding-left: 15px;margin-top: 10px}.wrap {text-align:left;display:inline-block;min-width:260px;max-width:500px}a{color:#000;font-weight:700;text-decoration:none}a:hover{color:#C038D3;text-decoration:none;}.q{height:16px;margin:0;padding:0 5px;text-align:right;min-width:38px;float:right}.q.q-0:after{background-position-x:0}.q.q-1:after{background-position-x:-16px}.q.q-2:after{background-position-x:-32px}.q.q-3:after{background-position-x:-48px}.q.q-4:after{background-position-x:-64px}.q.l:before{background-position-x:-80px;padding-right:5px}.ql .q{float:left}.q:after,.q:before{content:'';width:16px;height:16px;display:inline-block;background-repeat:no-repeat;background-position: 16px 0;background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAAAQCAMAAADeZIrLAAAAJFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADHJj5lAAAAC3RSTlMAIjN3iJmqu8zd7vF8pzcAAABsSURBVHja7Y1BCsAwCASNSVo3/v+/BUEiXnIoXkoX5jAQMxTHzK9cVSnvDxwD8bFx8PhZ9q8FmghXBhqA1faxk92PsxvRc2CCCFdhQCbRkLoAQ3q/wWUBqG35ZxtVzW4Ed6LngPyBU2CobdIDQ5oPWI5nCUwAAAAASUVORK5CYII=');}@media (-webkit-min-device-pixel-ratio: 2),(min-resolution: 192dpi){.q:before,.q:after {background-image:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALwAAAAgCAMAAACfM+KhAAAALVBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAOrOgAAAADnRSTlMAESIzRGZ3iJmqu8zd7gKjCLQAAACmSURBVHgB7dDBCoMwEEXRmKlVY3L//3NLhyzqIqSUggy8uxnhCR5Mo8xLt+14aZ7wwgsvvPA/ofv9+44334UXXngvb6XsFhO/VoC2RsSv9J7x8BnYLW+AjT56ud/uePMdb7IP8Bsc/e7h8Cfk912ghsNXWPpDC4hvN+D1560A1QPORyh84VKLjjdvfPFm++i9EWq0348XXnjhhT+4dIbCW+WjZim9AKk4UZMnnCEuAAAAAElFTkSuQmCC');background-size: 95px 16px;}}.msg{padding:20px;margin:20px 0;border:1px solid #eee;border-left-width:5px;border-left-color:#777}.msg h4{margin-top:0;margin-bottom:5px}.msg.P{border-left-color:#C038D3}.msg.P h4{color:#C038D3}.msg.D{border-left-color:#dc3630}.msg.D h4{color:#dc3630}.msg.S{border-left-color: #5cb85c}.msg.S h4{color: #5cb85c}dt{font-weight:bold}dd{margin:0;padding:0 0 0.5em 0;min-height:12px}td{vertical-align: top;}.h{display:none}button{transition: 0s opacity;transition-delay: 3s;transition-duration: 0s;cursor: pointer;border-radius:24px;box-shadow:5px 5px 10px 0 rgba(192,56,211,.3);}button.D{background-color:#C038D3}button:active{opacity:50% !important;cursor:wait;transition-delay: 0s}button:hover{background-color:#C038D3}body.invert,body.invert a,body.invert h1 {background-color:#060606;color:#fff;}body.invert .msg{color:#fff;background-color:#282828;border-top:1px solid #555;border-right:1px solid #555;border-bottom:1px solid #555;}body.invert .q[role=img]{-webkit-filter:invert(1);filter:invert(1);}:disabled {opacity: 0.5;}@keyframes rotate{from{transform:rotate(0deg);}to{transform:rotate(360deg);}}</style>
</head>
<body class='{c}'>
<div class='wrap'>
  <div class='logo-cont'>
    <div class='logo-img'><svg class='pic' alt='логотип' fill='none' height='34' viewBox='0 0 34 34' width='34' xmlns='http://www.w3.org/2000/svg'><circle stroke='dodgerblue' stroke-width='4' r='15.0' cx='17.0' cy='17.0'></circle><rect fill='lightcoral' x='14' y='14' height='6' width='15' ry='3' transform='rotate(-40 17 17)'></svg></div>
    <p class='logo-text'>eMeter</p>
  </div>
  <h3>Сканируем WiFi сети...</h3>
  <div><a href='#pp' onclick='c(this)' data-ssid='private-koptevo-wlan-ext'>private-koptevo-wlan-ext</a>
    <div role='img' aria-label='98%' title='98%' class='q q-4 l '></div>
    <div class='q h'>98%</div>
  </div>
  <div><a href='#pp' onclick='c(this)' data-ssid='private-koptevo-wlan-bgn'>private-koptevo-wlan-bgn</a>
    <div role='img' aria-label='72%' title='72%' class='q q-3 l '></div>
    <div class='q h'>72%</div>
  </div>
  <div><a href='#pp' onclick='c(this)' data-ssid='grech'>grech</a>
    <div role='img' aria-label='64%' title='64%' class='q q-3 l '></div>
    <div class='q h'>64%</div>
  </div>
  <div><a href='#pp' onclick='c(this)' data-ssid='Keenetic-1227'>Keenetic-1227</a>
    <div role='img' aria-label='64%' title='64%' class='q q-3 l '></div>
    <div class='q h'>64%</div>
  </div>
  <br/>
  <form method='POST' action='wifisave'>
    <label for='s'>Имя WiFi сети:</label>
    <input id='s' name='s' maxlength='32' autocorrect='off' autocapitalize='none' placeholder='private-koptevo-wlan-bgn'>
    <br/>
    <label for='p'>Пароль:</label>
    <input id='p' name='p' maxlength='64' type='password' placeholder='********'>
    <input type='checkbox' onclick='f()'>
    Показать пароль<br/>
    <br/>
    <h3>Электроэнергия</h3>
    <label for='counter_t1'>Показания счетчика T1, кВт*ч:</label>
    <br/>
    <input id='counter_t1' name='counter_t1' maxlength='10' value='0.000'  type="number" step="0.01" placeholder="0,00">
    <label for='counter_t2'>Показания счетчика T2, кВт*ч:</label>
    <br/>
    <input id='counter_t2' name='counter_t2' maxlength='10' value='0.000'  type="number" step="0.01" placeholder="0,00">
    <label for='coeff'>Коэффициент счетчика, имп./кВт*ч:</label>
    <br/>
    <input id='coeff' name='coeff' maxlength='10' value='3200'  type="number">
    <h3>MQTT</h3>
    <label for='mqtt_period'>Период отправки показаний, мин.:</label>
    <br/>
    <input id='mqtt_period' name='mqtt_period' maxlength='10' value='1'  type="number">
    <label for='mqtt_host'>Адрес брокера:</label>
    <br/>
    <input id='mqtt_host' name='mqtt_host' maxlength='43' value='' >
    <label for='mqtt_port'>Порт:</label>
    <br/>
    <input id='mqtt_port' name='mqtt_port' maxlength='10' value='1883'  type="number">
    <label for='mqtt_login'>Логин:</label>
    <br/>
    <input id='mqtt_login' name='mqtt_login' maxlength='31' value='mqtt' >
    <label for='mqtt_password'>Пароль:</label>
    <br/>
    <input id='mqtt_password' name='mqtt_password' maxlength='31' value='mqtt' >
    <label for='mqtt_topic'>Топик данных:</label>
    <br/>
    <input id='mqtt_topic' name='mqtt_topic' maxlength='63' value='eMeter/908613/' >
    <label for='mqtt_discovery_topic'>Топик Home Assistant:</label>
    <br/>
    <input id='mqtt_discovery_topic' name='mqtt_discovery_topic' maxlength='63' value='homeassistant' >
    <label class='chk-box'>Автоматическое добавление в Home Assistant<br/>
    <input id='mqtt_auto_discovery' name='mqtt_auto_discovery' maxlength='2' value='T'  type="checkbox" checked>
    <span class='box'></span></label>
    <h3>Статистика</h3>
    <label for='stat_period'>Период отправки статистики, сек.:</label>
    <br/>
    <input id='stat_period' name='stat_period' maxlength='10' value='600'  type="number">
    <label for='stat_host'>URL сбора статистики:</label>
    <br/>
    <input id='stat_host' name='stat_host' maxlength='63' value='http://home.shokurov.ru/energy' >
    <label class='chk-box'>Расширенные настройки
    <input type='checkbox' id='chbox' name='chbox' onclick='extraConf()'>
    <span class='box'></span></label>
    <div id='extra_conf' style='display:none'>
      <h3>Сетевые настройки</h3>
      <label>MAC адрес: D8:F1:5B:0D:DD:45</label>
      <br />
      <br />
      <label for='ip'>Статический IP (оставьте 0.0.0.0 для DHCP):</label>
      <br/><input id='ip' name='ip' maxlength='16' value='0.0.0.0' minlength="7" maxlength="15" size="15" pattern="^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$"> 
      <label for='gateway'>Шлюз:</label>
      <br/><input id='gateway' name='gateway' maxlength='16' value='192.168.0.1' minlength="7" maxlength="15" size="15" pattern="^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$"> 
      <label for='mask'>Маска подсети:</label>
      <br/><input id='mask' name='mask' maxlength='16' value='255.255.255.0' minlength="7" maxlength="15" size="15" pattern="^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$"> 
      <label>Режим работы WiFi:</label>
      <label for='wifi_phy_mode'></label>
      <select class='drop' id='wifi_phy_mode' name='wifi_phy_mode'>
        <option selected value='3'>11n</option>
      </select>
      <label for='ntp_server'>Сервер времени (NTP):</label>
      <br/>
      <input id='ntp_server' name='ntp_server' maxlength='63' value='ru.pool.ntp.org' >
      <label for='tz'>Часовой пояс (разница с UTC):</label>
      <br/>
      <input id='tz' name='tz' maxlength='10' value='3'  type="number">
    </div>
    <br/>
    <br/>
    <button type='submit'>Сохранить</button>
  </form>
</div>
</body>
</html>
